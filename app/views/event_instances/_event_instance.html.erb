<turbo-frame id="event_instance_<%= instance.id %>">
  <% bookings_to_show = instance.bookings %>
  <% bookings_to_show.each do |booking| %>
    <turbo-frame id="booking_<%= booking.id %>">
      <div class="d-flex justify-content-between align-items-start">
        <div class="d-flex align-items-end" style="margin-top: -6px;">
          <a
            class="text-decoration-none d-flex align-items-center"
            style="color: black;"
            data-bs-toggle="collapse"
            data-bs-target="#dropdown_<%= booking.id %>"
            aria-expanded="false"
            aria-controls="dropdown_<%= booking.id %>"
            data-booking-id="<%= booking.id %>"
          >
            <i id="caret_<%= booking.id %>" class="fa-solid fa-caret-right caret-icon me-1" style="margin-bottom: 2px;"></i>
            <span class="d-flex <%= 'mt-1' if booking.status.in?(%w[cancelled_by_teacher cancelled_by_student]) %>">
              <%= booking.id %>&nbsp;<%= booking.user.first_name %> â€“&nbsp;
              <% if booking.status == "pending" && booking.waitlisted? %>
                <span style="color: #9d94ad;">waitlisted</span>
              <% else %>
                <span style="<%= 'color: #5e9e6b; font-weight: 600;' if booking.status == 'confirmed' %>"><%= booking.status %></span>
              <% end %>
            </span>
          </a>
        </div>
        <!-- Dropdown Content -->
        <div class="collapse mt-2" id="dropdown_<%= booking.id %>">
          <div class="p-2" style="border-radius: 5px;">
            <!-- More content here -->
          </div>
        </div>
      </div>
    </turbo-frame>
  <% end %>
</turbo-frame>
<script>
  document.addEventListener('turbo:load', function () {
    document.querySelectorAll('[data-bs-toggle="collapse"]').forEach(function (toggle) {
      const targetSelector = toggle.getAttribute('data-bs-target');
      const bookingId = toggle.getAttribute('data-booking-id');
      const caret = document.getElementById(`caret_${bookingId}`);
      const target = document.querySelector(targetSelector);

      if (!caret || !target) return;

      target.addEventListener('show.bs.collapse', function () {
        caret.classList.add('caret-rotated');
      });

      target.addEventListener('hide.bs.collapse', function () {
        caret.classList.remove('caret-rotated');
      });
    });
  });
</script>
